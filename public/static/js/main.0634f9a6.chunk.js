(this.webpackJsonpwebsite=this.webpackJsonpwebsite||[]).push([[0],{161:function(e,t,n){},166:function(e,t,n){},167:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),c=n(14),s=n.n(c),o=n(38),i=n(23),l=n(232),u=n(18),d=n.n(u),j=n(29),b=n(43),p=n(217),m=n(218),h=n(219),f=n(220),g=n(221),O=n(222),x=n(223),v=n(235),y=n(236),w=n(224),k=n(225),C=n(226),S=n(227),T=n(228),I=n(229),A=n(120),B=n(117),W=n.n(B),P=a.a.createContext(),F=n(47),L=n.n(F),N=n(230),z=n(114),U=n(19);var q={init:function(){N.a({dsn:"https://5b7214cfc4b84b6b83aa0ad69b43e6ed@o476740.ingest.sentry.io/5516810",integrations:[new z.a.GlobalHandlers({onunhandledrejection:!1,onerror:!1})],tracesSampleRate:1,enabled:!1})},log:function(e){U.a(e)}};L.a.interceptors.response.use(null,(function(e){return e.response&&e.response.status>=400&&e.response.status<500||(console.log("Logging the error",e),q.log(e),alert("An unexpected error occured.")),Promise.reject(e)}));var D={get:L.a.get,post:L.a.post,put:L.a.put,patch:L.a.patch,delete:L.a.delete,setAccessToken:function(e){L.a.defaults.headers.common.Authorization="Bearer ".concat(e)}},R=n(83),E={setAccessToken:function(e){var t=Object(R.a)(e);localStorage.setItem("user",JSON.stringify(t)),localStorage.setItem("accessToken",e)},getAccessToken:function(){var e=localStorage.getItem("accessToken");return e||null},getUser:function(){var e=localStorage.getItem("user");return e?JSON.parse(e):null},removeAccessToken:function(){return localStorage.removeItem("accessToken")},removeUser:function(){return localStorage.removeItem("user")}},J=function(){var e=Object(j.a)(d.a.mark((function e(t,n){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",D.post("/api/login",{username:t,password:n}));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),V=function(){var e=Object(j.a)(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",D.post("/api/signup",t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();D.setAccessToken(E.getAccessToken());var _={login:J,signup:V,logout:function(){E.removeAccessToken(),E.removeUser()},getAllPermissions:function(e){return D.get("/api/permissions")},checkPermissions:function(e,t){return D.post("/api/users/".concat(e,"/permissions"),{permissionIds:t})}},G=n(5),H=Object(l.a)((function(e){return{root:{width:"100%"},menuIconButton:Object(b.a)({marginRight:e.spacing(2),display:"none"},e.breakpoints.down(600),{display:"block"}),loginButton:{marginLeft:20,fontWeight:"bold",textTransform:"none"}}}));var K=function(){var e=H(),t=Object(r.useContext)(P).user,n=function(){var e=Object(j.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:_.logout(),window.location.replace("/");case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(G.jsx)("div",{className:e.root,children:Object(G.jsx)(p.a,{position:"sticky",color:"secondary",children:Object(G.jsx)(m.a,{variant:"dense",children:Object(G.jsx)(g.a,{container:!0,alignItems:"center",justify:"flex-end",children:Object(G.jsx)(g.a,{children:t?Object(G.jsxs)(f.a,{className:e.loginButton,variant:"contained",size:"small",color:"primary",onClick:n,children:[Object(G.jsx)(W.a,{style:{marginRight:10}}),"Logout"]}):null})})})})})},M=(n(161),n(16)),Q=Object(l.a)({table:{minWidth:650}});var X=function(){var e=Q(),t=Object(r.useState)(!1),n=Object(i.a)(t,2),a=n[0],c=n[1],s=Object(r.useState)([]),o=Object(i.a)(s,2),l=o[0],u=o[1],b=Object(r.useContext)(P).user,p=function(){var e=Object(j.a)(d.a.mark((function e(){var t,n,r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,_.getAllPermissions();case 3:t=e.sent,n=t.data,r=n.map((function(e){return e.id})),m(r),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),c("Failed to load permissions.");case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}(),m=function(){var e=Object(j.a)(d.a.mark((function e(t){var n,r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,_.checkPermissions(b.sub,t);case 3:n=e.sent,r=n.data,u(r),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),c("Failed to load permissions.");case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}();return Object(r.useEffect)((function(){b&&p()}),[b]),b?Object(G.jsxs)(g.a,{container:!0,direction:"column",alignItems:"center",justify:"center",children:[a&&Object(G.jsx)(y.a,{severity:"error",style:{marginBottom:20},children:a}),Object(G.jsxs)(S.a,{style:{width:580,textAlign:"center"},component:A.a,children:[Object(G.jsx)(h.a,{variant:"h5",style:{marginBottom:30,marginTop:10,fontWeight:"bolder"},children:"Permissions"}),Object(G.jsxs)(w.a,{className:e.table,"aria-label":"simple table",children:[Object(G.jsx)(T.a,{children:Object(G.jsxs)(I.a,{children:[Object(G.jsx)(C.a,{children:"ID"}),Object(G.jsx)(C.a,{align:"left",children:"Name"}),Object(G.jsx)(C.a,{align:"left",children:"Code"}),Object(G.jsx)(C.a,{align:"left",children:"Allowed"})]})}),Object(G.jsx)(k.a,{children:l.map((function(e){return Object(G.jsxs)(I.a,{children:[Object(G.jsx)(C.a,{component:"th",scope:"row",children:e.id}),Object(G.jsx)(C.a,{align:"left",children:e.name}),Object(G.jsx)(C.a,{align:"left",children:e.code}),Object(G.jsx)(C.a,{align:"left",children:e.isAllowed})]},e.id)}))})]})]})]}):Object(G.jsx)(M.a,{to:"/login"})},Y=n(42),Z=Object(l.a)((function(e){return{card:{minWidth:250,maxWidth:550,textAlign:"center",marginRight:10,marginLeft:10}}}));var $=function(e){var t=e.handleLogin,n=Z(),a=Object(r.useContext)(P).user,c=Object(r.useState)({id:"",password:""}),s=Object(i.a)(c,2),l=s[0],u=s[1],p=function(e){var t=e.target,n=t.id,r=t.value;u(Object(o.a)(Object(o.a)({},l),{},Object(b.a)({},n,r)))},m=Object(r.useState)(""),w=Object(i.a)(m,2),k=w[0],C=w[1],S=Object(r.useState)(!1),T=Object(i.a)(S,2),I=T[0],A=T[1],B=function(){var e=Object(j.a)(d.a.mark((function e(){var n,r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(l.id){e.next=2;break}return e.abrupt("return",C("ID is required."));case 2:if(l.password){e.next=4;break}return e.abrupt("return",C("Password is required."));case 4:return C(""),A(!0),e.prev=6,e.next=9,_.login(l.id,l.password);case 9:n=e.sent,r=n.data,A(!1),t(Object(R.a)(r.access_token)),E.setAccessToken(r.access_token),window.location.replace("/"),e.next=21;break;case 17:e.prev=17,e.t0=e.catch(6),A(!1),C(e.t0.response.data.error);case 21:case"end":return e.stop()}}),e,null,[[6,17]])})));return function(){return e.apply(this,arguments)}}();return a?Object(G.jsx)(M.a,{to:"/"}):Object(G.jsxs)(g.a,{container:!0,direction:"column",alignItems:"center",justify:"center",children:[Object(G.jsx)(O.a,{className:n.card,children:Object(G.jsxs)(x.a,{children:[Object(G.jsx)(h.a,{variant:"h5",style:{marginBottom:30,marginTop:10,fontWeight:"bolder"},children:"Sign In"}),k&&Object(G.jsx)(y.a,{severity:"error",style:{marginBottom:20},children:k}),Object(G.jsxs)("form",{noValidate:!0,autoComplete:"off",children:[Object(G.jsx)(v.a,{style:{marginBottom:15},id:"id",label:"ID",placeholder:"email or username",variant:"outlined",fullWidth:!0,type:"text",color:"secondary",size:"small",onChange:p}),Object(G.jsx)(v.a,{style:{marginBottom:15},id:"password",label:"Password",placeholder:"*******",variant:"outlined",fullWidth:!0,type:"password",color:"secondary",size:"small",onChange:p})]}),Object(G.jsx)(f.a,{variant:"contained",color:"secondary",fullWidth:!0,onClick:B,style:{textTransform:"none"},disabled:I,children:"Log In"})]})}),Object(G.jsxs)(h.a,{variant:"body2",style:{marginTop:10},children:["Need an account?"," ",Object(G.jsx)(Y.b,{to:"/signup",style:{textDecoration:"none"},children:"Sign Up"})]})]})};var ee=function(){return Object(G.jsx)(g.a,{container:!0,direction:"column",alignItems:"center",justify:"center",children:Object(G.jsx)("p",{children:"Page not found!"})})},te=Object(l.a)((function(e){return{card:{minWidth:250,maxWidth:550,textAlign:"center",marginRight:10,marginLeft:10}}}));var ne=function(){var e=te(),t=Object(M.g)(),n=Object(r.useState)({email:"",username:"",password:"",passwordConfirm:""}),a=Object(i.a)(n,2),c=a[0],s=a[1],l=Object(r.useState)(""),u=Object(i.a)(l,2),p=u[0],m=u[1],w=Object(r.useState)(!1),k=Object(i.a)(w,2),C=k[0],S=k[1],T=Object(r.useState)(!1),I=Object(i.a)(T,2),A=I[0],B=I[1],W=function(e){var t=e.target,n=t.id,r=t.value;s(Object(o.a)(Object(o.a)({},c),{},Object(b.a)({},n,r)))},P=function(){var e=Object(j.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c.email){e.next=2;break}return e.abrupt("return",m("Email is required."));case 2:if(c.username){e.next=4;break}return e.abrupt("return",m("Username is required."));case 4:if(c.password){e.next=6;break}return e.abrupt("return",m("Password is required."));case 6:if(c.passwordConfirm){e.next=8;break}return e.abrupt("return",m("Password confirmation is required."));case 8:if(c.password===c.passwordConfirm){e.next=10;break}return e.abrupt("return",m("Passwords do not match"));case 10:return e.prev=10,m(""),B(!0),e.next=15,_.signup(c);case 15:S(!0),setTimeout((function(){t.push("/login")}),2e3),e.next=22;break;case 19:e.prev=19,e.t0=e.catch(10),m(e.t0.response.data.error);case 22:B(!1);case 23:case"end":return e.stop()}}),e,null,[[10,19]])})));return function(){return e.apply(this,arguments)}}();return Object(G.jsxs)(g.a,{container:!0,direction:"column",alignItems:"center",justify:"center",children:[Object(G.jsx)(O.a,{className:e.card,children:Object(G.jsxs)(x.a,{children:[Object(G.jsx)(h.a,{variant:"h5",style:{marginBottom:30,marginTop:10,fontWeight:"bolder"},children:"Sign Up"}),p&&Object(G.jsx)(y.a,{severity:"error",style:{marginBottom:20},children:p}),C&&Object(G.jsx)(y.a,{severity:"success",style:{marginBottom:20},children:"Account created successfully, redirecting to login page..."}),Object(G.jsxs)("form",{noValidate:!0,autoComplete:"off",children:[Object(G.jsx)(v.a,{style:{marginBottom:15},id:"email",label:"Email",variant:"outlined",fullWidth:!0,type:"email",color:"secondary",size:"small",onChange:W}),Object(G.jsx)(v.a,{style:{marginBottom:15},id:"username",label:"Username",variant:"outlined",fullWidth:!0,type:"text",color:"secondary",size:"small",onChange:W}),Object(G.jsx)(v.a,{style:{marginBottom:15},id:"password",label:"Password",variant:"outlined",fullWidth:!0,type:"password",color:"secondary",size:"small",onChange:W}),Object(G.jsx)(v.a,{style:{marginBottom:15},id:"passwordConfirm",label:"Confirm Password",variant:"outlined",fullWidth:!0,type:"password",color:"secondary",size:"small",onChange:W})]}),Object(G.jsx)(f.a,{variant:"contained",color:"secondary",fullWidth:!0,onClick:P,style:{textTransform:"none"},disabled:A,children:"Submit"})]})}),Object(G.jsxs)(h.a,{variant:"body2",style:{marginTop:10},children:["Already have an account?"," ",Object(G.jsx)(Y.b,{to:"/login",style:{textDecoration:"none"},children:"Log In"})]})]})},re=Object(l.a)((function(e){return{contentContainer:{marginRight:"auto",marginLeft:"auto",maxWidth:1500,backgroundColor:"#eeeeee",height:"93vh",overflow:"scroll"}}}));var ae=function(){var e=re(),t=Object(r.useState)(E.getUser()),n=Object(i.a)(t,2),a=n[0],c=n[1],s=function(e){c(e)};return Object(G.jsx)(P.Provider,{value:{user:a},children:Object(G.jsxs)(g.a,{container:!0,children:[Object(G.jsx)(K,{}),Object(G.jsx)(g.a,{container:!0,className:e.contentContainer,children:Object(G.jsxs)(M.d,{children:[Object(G.jsx)(M.b,{path:"/",exact:!0,component:X}),Object(G.jsx)(M.b,{path:"/login",exact:!0,render:function(e){return Object(G.jsx)($,Object(o.a)(Object(o.a)({},e),{},{handleLogin:s}))}}),Object(G.jsx)(M.b,{path:"/signup",exact:!0,component:ne}),Object(G.jsx)(M.b,{path:"/not-found",exact:!0,component:ee}),Object(G.jsx)(M.a,{to:"/not-found"})]})})]})})},ce=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,237)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,c=t.getLCP,s=t.getTTFB;n(e),r(e),a(e),c(e),s(e)}))},se=n(233),oe=n(234),ie=n(118),le=Object(ie.a)({palette:{primary:{main:"#FFFFFF"},secondary:{main:"#000000"}}});n(165),n(166);q.init(),s.a.render(Object(G.jsx)(se.a,{fallback:"An error has occurred",children:Object(G.jsx)(Y.a,{children:Object(G.jsx)(oe.a,{theme:le,children:Object(G.jsx)(ae,{})})})}),document.getElementById("root")),ce()}},[[167,1,2]]]);
//# sourceMappingURL=main.0634f9a6.chunk.js.map